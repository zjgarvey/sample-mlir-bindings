This repository contains some small examples of working with torch-mlir python bindings.

## Setup

```bash
python -m venv sample.venv
source sample.venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

## Get Example IR

Generate some mlir files and sample inputs/outputs with:

```bash
python py/generate_examples.py
```

This python file has some simple examples of how to generate some mlir using the torch-mlir fx importer. 

## Read IR with python bindings

The file `py/torch_mlir_to_pseudo_fx.py` has some examples of how to use mlir python api to get information that might be contained in an fx graph. Try running:

```bash
python py/torch_mlir_to_pseudo_fx.py mlir/<some_example>.mlir
```

## Compile and run mlir examples with IREE

The script `py/compile_and_run_with_iree.py` will take the examples generated by `py/generate_examples.py` and will run them through iree flow. Run with `--verbose` and specify a log file with `--log-file=...` to get command line reproducers for the compile and run commands. You can also run with `--compare` to have the script compare iree generated outputs against torch generated outputs. 


